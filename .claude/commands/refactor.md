Analyze and refactor the entire project according to best practices:

1. Scan all source files in src/ for code quality issues
2. Improve code readability and maintainability
3. Extract repeated code into reusable functions
4. Simplify complex conditionals
5. Use descriptive variable and function names
6. Remove dead code and unused imports
7. Ensure consistent formatting and style
8. Add or improve type annotations where beneficial
9. Consolidate duplicate logic across files
10. Keep changes minimal and focused - don't over-engineer

After refactoring, run `npm run lint` to verify all changes pass linting.
